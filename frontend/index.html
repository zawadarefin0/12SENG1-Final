<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PetSeek</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  </head>
  <body>
    <div class="nav-container">
      <a href="index.html">
        <img src="assets/banner.png" alt="" />
      </a>
      <div id="auth-container"></div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        async function updateAuthArea() {
          console.log("function is working");
          const res = await fetch("/auth/status");
          const status = await res.json();
          const authDiv = document.getElementById("auth-container");

          if (status.loggedIn) {
            console.log("logged in");
            const logoutBtn = document.createElement("button");
            logoutBtn.textContent = "Logout";
            logoutBtn.id = "logout";
            logoutBtn.addEventListener("click", logout);
            authDiv.appendChild(logoutBtn);
          } else {
            console.log("logged out");
            const loginLink = document.createElement("a");
            loginLink.href = "auth.html";

            const loginDiv = document.createElement("div");
            loginDiv.className = "login";
            loginDiv.textContent = "Login";

            loginLink.appendChild(loginDiv);
            authDiv.appendChild(loginLink);

            const registerDiv = document.createElement("div");
            registerDiv.className = "register";

            const registerLink = document.createElement("a");
            registerLink.href = "auth.html?action=register";
            registerLink.textContent = "Register";

            registerDiv.appendChild(registerLink);
            authDiv.appendChild(registerDiv);
          }
        }

        async function logout() {
          logoutBtn = document.getElementById("logout")
          await fetch("/auth/logout", { method: "POST" });
          logoutBtn.remove();
          updateAuthArea();
        }

        updateAuthArea();
      });
    </script>
  </body>
</html>
