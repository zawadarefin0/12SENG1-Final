<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PetSeek</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link rel="stylesheet" href="pet-owner.css" />
  </head>
  <body>
    <div class="nav-container">
      <a href="index.html">
        <img src="assets/banner.png" alt="" />
      </a>
      <div id="auth-container"></div>
    </div>
    <div class="container">
      <div class="left">
        <div class="posts">
          <div class="post">
            <div class="post-left">
              <p>Post</p>
            </div>
            <div class="post-right">
              <div class="image">image</div>
            </div>
          </div>
          <div class="post">
            <div class="post-left">
              <p>Post</p>
            </div>
            <div class="post-right">
              <div class="image">image</div>
            </div>
          </div>
          <div class="post">
            <div class="post-left">
              <p>Post</p>
            </div>
            <div class="post-right">
              <div class="image">image</div>
            </div>
          </div>
        </div>
      </div>
      <div class="right">
        <form action="">
          <h1>Add your pet!</h1>
          <div class="nameage-container">
            <div class="name">
              <input
                maxlength="40"
                type="name"
                name="name"
                placeholder="Your Pet Name . . ."
                required
              />
            </div>
            <div class="age">
              <input type="number" min="1" max="99" placeholder="Age . . . " />
            </div>
          </div>
          <div class="description">
            <textarea
              maxlength="90"
              type="name"
              name="name"
              placeholder="Description . . ."
              required
            ></textarea>
          </div>
          <div class="selection">
            
          </div>
          <button type="submit" class="btn">Submit</button>
        </form>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        async function updateAuthArea() {
          console.log("function is working");
          const res = await fetch("/auth/status");
          const status = await res.json();
          const authDiv = document.getElementById("auth-container");

          if (status.loggedIn) {
            console.log("logged in");
            const logoutBtn = document.createElement("button");
            logoutBtn.textContent = "Logout";
            logoutBtn.id = "logout";
            logoutBtn.addEventListener("click", logout);
            authDiv.appendChild(logoutBtn);
          } else {
            console.log("logged out");
            const loginLink = document.createElement("a");
            loginLink.href = "auth.html";

            const loginDiv = document.createElement("div");
            loginDiv.className = "login";
            loginDiv.textContent = "Login";

            loginLink.appendChild(loginDiv);
            authDiv.appendChild(loginLink);

            const registerDiv = document.createElement("div");
            registerDiv.className = "register";

            const registerLink = document.createElement("a");
            registerLink.href = "auth.html?action=register";
            registerLink.textContent = "Register";

            registerDiv.appendChild(registerLink);
            authDiv.appendChild(registerDiv);
          }
        }

        async function logout() {
          await fetch("/auth/logout", { method: "POST" });
          document.location.href = "index.html";
        }

        updateAuthArea();
      });
    </script>
  </body>
</html>
